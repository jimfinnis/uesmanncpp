<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>UESMANN CPP: BPNet Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UESMANN CPP
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Reference implementation of UESMANN</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classBPNet-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">BPNet Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The "basic" back-propagation network using a logistic sigmoid, as described by Rumelhart, Hinton and Williams (and many others). This class is used by output blending and h-as-input networks.  
 <a href="classBPNet.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for BPNet:</div>
<div class="dyncontent">
<div class="center"><img src="classBPNet__inherit__graph.png" border="0" usemap="#BPNet_inherit__map" alt="Inheritance graph"/></div>
<map name="BPNet_inherit__map" id="BPNet_inherit__map">
<area shape="rect" id="node3" href="classHInputNet.html" title="A modulatory network architecture which uses a plain backprop network with an extra input to carry th..." alt="" coords="5,155,88,181"/>
<area shape="rect" id="node4" href="classUESNet.html" title="The UESMANN network, which it itself based on the BPNet code as it has the same architecture as the p..." alt="" coords="113,155,183,181"/>
<area shape="rect" id="node2" href="classNet.html" title="The abstract network type upon which all others are based. It&#39;s not pure virtual, in that it encapsul..." alt="" coords="76,5,119,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for BPNet:</div>
<div class="dyncontent">
<div class="center"><img src="classBPNet__coll__graph.png" border="0" usemap="#BPNet_coll__map" alt="Collaboration graph"/></div>
<map name="BPNet_coll__map" id="BPNet_coll__map">
<area shape="rect" id="node2" href="classNet.html" title="The abstract network type upon which all others are based. It&#39;s not pure virtual, in that it encapsul..." alt="" coords="15,5,57,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:acc0ad3e9fb7c706a4bc8676b3aaf47b8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#acc0ad3e9fb7c706a4bc8676b3aaf47b8">BPNet</a> (int nlayers, const int *layerCounts)</td></tr>
<tr class="memdesc:acc0ad3e9fb7c706a4bc8676b3aaf47b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor - does not initialise the weights to random values so that we can reinitialise networks.  <a href="#acc0ad3e9fb7c706a4bc8676b3aaf47b8">More...</a><br /></td></tr>
<tr class="separator:acc0ad3e9fb7c706a4bc8676b3aaf47b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98fa374aec169a3e741f2ce96fac7094"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a98fa374aec169a3e741f2ce96fac7094">setH</a> (double h)</td></tr>
<tr class="memdesc:a98fa374aec169a3e741f2ce96fac7094"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the modulator level for subsequent runs and training of this network.  <a href="#a98fa374aec169a3e741f2ce96fac7094">More...</a><br /></td></tr>
<tr class="separator:a98fa374aec169a3e741f2ce96fac7094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef1082e622022f25bee51013fab29aa0"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#aef1082e622022f25bee51013fab29aa0">getH</a> () const </td></tr>
<tr class="memdesc:aef1082e622022f25bee51013fab29aa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the modulator level  <a href="#aef1082e622022f25bee51013fab29aa0">More...</a><br /></td></tr>
<tr class="separator:aef1082e622022f25bee51013fab29aa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a452b3f05cc7e72b897a3546a38c010"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a7a452b3f05cc7e72b897a3546a38c010">~BPNet</a> ()</td></tr>
<tr class="memdesc:a7a452b3f05cc7e72b897a3546a38c010"><td class="mdescLeft">&#160;</td><td class="mdescRight">destructor  <a href="#a7a452b3f05cc7e72b897a3546a38c010">More...</a><br /></td></tr>
<tr class="separator:a7a452b3f05cc7e72b897a3546a38c010"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad95c2a033ee8246637a6ce55e685429a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#ad95c2a033ee8246637a6ce55e685429a">setInputs</a> (double *d)</td></tr>
<tr class="memdesc:ad95c2a033ee8246637a6ce55e685429a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the inputs to the network before running or training.  <a href="#ad95c2a033ee8246637a6ce55e685429a">More...</a><br /></td></tr>
<tr class="separator:ad95c2a033ee8246637a6ce55e685429a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9e80dbedb62e973efdef21745a4a27a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#ae9e80dbedb62e973efdef21745a4a27a">setInput</a> (int n, double d)</td></tr>
<tr class="memdesc:ae9e80dbedb62e973efdef21745a4a27a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to set inputs manually, typically in <a class="el" href="classHInputNet.html" title="A modulatory network architecture which uses a plain backprop network with an extra input to carry th...">HInputNet</a>.  <a href="#ae9e80dbedb62e973efdef21745a4a27a">More...</a><br /></td></tr>
<tr class="separator:ae9e80dbedb62e973efdef21745a4a27a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf9256df2239cdef0cb7ad3b45d0e06e"><td class="memItemLeft" align="right" valign="top">virtual double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#adf9256df2239cdef0cb7ad3b45d0e06e">getOutputs</a> () const </td></tr>
<tr class="memdesc:adf9256df2239cdef0cb7ad3b45d0e06e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the outputs after running.  <a href="#adf9256df2239cdef0cb7ad3b45d0e06e">More...</a><br /></td></tr>
<tr class="separator:adf9256df2239cdef0cb7ad3b45d0e06e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbf10480c672d8a6e3cbf4071f447cc8"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#afbf10480c672d8a6e3cbf4071f447cc8">getLayerSize</a> (int n) const </td></tr>
<tr class="memdesc:afbf10480c672d8a6e3cbf4071f447cc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of nodes in a given layer.  <a href="#afbf10480c672d8a6e3cbf4071f447cc8">More...</a><br /></td></tr>
<tr class="separator:afbf10480c672d8a6e3cbf4071f447cc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af52311c47d488b0121ea59574e2b9c05"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#af52311c47d488b0121ea59574e2b9c05">getLayerCount</a> () const </td></tr>
<tr class="memdesc:af52311c47d488b0121ea59574e2b9c05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of layers.  <a href="#af52311c47d488b0121ea59574e2b9c05">More...</a><br /></td></tr>
<tr class="separator:af52311c47d488b0121ea59574e2b9c05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0071a9b17ba5d42959ce600d29a255c"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#ab0071a9b17ba5d42959ce600d29a255c">getDataSize</a> () const </td></tr>
<tr class="memdesc:ab0071a9b17ba5d42959ce600d29a255c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the length of the serialised data block for this network.  <a href="#ab0071a9b17ba5d42959ce600d29a255c">More...</a><br /></td></tr>
<tr class="separator:ab0071a9b17ba5d42959ce600d29a255c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ef14370548350daecedcb275ba88c07"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a7ef14370548350daecedcb275ba88c07">save</a> (double *buf) const </td></tr>
<tr class="memdesc:a7ef14370548350daecedcb275ba88c07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize the data (not including any network type magic number or layer/node counts) to the given memory (which must be of sufficient size).  <a href="#a7ef14370548350daecedcb275ba88c07">More...</a><br /></td></tr>
<tr class="separator:a7ef14370548350daecedcb275ba88c07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11724f2263de9dcbc0f9172b464732c7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a11724f2263de9dcbc0f9172b464732c7">load</a> (double *buf)</td></tr>
<tr class="memdesc:a11724f2263de9dcbc0f9172b464732c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given that the pointer points to a data block of the correct size for the current network, copy the parameters from that data block into the current network overwriting the current parameters.  <a href="#a11724f2263de9dcbc0f9172b464732c7">More...</a><br /></td></tr>
<tr class="separator:a11724f2263de9dcbc0f9172b464732c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classNet"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classNet')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classNet.html">Net</a></td></tr>
<tr class="memitem:a882ce3a3037e5fe06f1a11f87cb0629d inherit pub_methods_classNet"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a882ce3a3037e5fe06f1a11f87cb0629d">~Net</a> ()</td></tr>
<tr class="memdesc:a882ce3a3037e5fe06f1a11f87cb0629d inherit pub_methods_classNet"><td class="mdescLeft">&#160;</td><td class="mdescRight">virtual destructor which does nothing  <a href="#a882ce3a3037e5fe06f1a11f87cb0629d">More...</a><br /></td></tr>
<tr class="separator:a882ce3a3037e5fe06f1a11f87cb0629d inherit pub_methods_classNet"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ef424e05bfeff073bbca57a5735c121 inherit pub_methods_classNet"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a2ef424e05bfeff073bbca57a5735c121">setSeed</a> (long seed)</td></tr>
<tr class="memdesc:a2ef424e05bfeff073bbca57a5735c121 inherit pub_methods_classNet"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set this network's random number generator, which is used for weight initialisation done at the start of training.  <a href="#a2ef424e05bfeff073bbca57a5735c121">More...</a><br /></td></tr>
<tr class="separator:a2ef424e05bfeff073bbca57a5735c121 inherit pub_methods_classNet"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53df5c1c5703b73ee5a7ccb7537b66a9 inherit pub_methods_classNet"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a53df5c1c5703b73ee5a7ccb7537b66a9">getInputCount</a> () const </td></tr>
<tr class="memdesc:a53df5c1c5703b73ee5a7ccb7537b66a9 inherit pub_methods_classNet"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the number of inputs  <a href="#a53df5c1c5703b73ee5a7ccb7537b66a9">More...</a><br /></td></tr>
<tr class="separator:a53df5c1c5703b73ee5a7ccb7537b66a9 inherit pub_methods_classNet"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f96e2ae07bec62b8c97ab192528f3c3 inherit pub_methods_classNet"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a5f96e2ae07bec62b8c97ab192528f3c3">getOutputCount</a> () const </td></tr>
<tr class="memdesc:a5f96e2ae07bec62b8c97ab192528f3c3 inherit pub_methods_classNet"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the number of outputs  <a href="#a5f96e2ae07bec62b8c97ab192528f3c3">More...</a><br /></td></tr>
<tr class="separator:a5f96e2ae07bec62b8c97ab192528f3c3 inherit pub_methods_classNet"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f711482dd39b9653f4449304b853a79 inherit pub_methods_classNet"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a3f711482dd39b9653f4449304b853a79">run</a> (double *in)</td></tr>
<tr class="memdesc:a3f711482dd39b9653f4449304b853a79 inherit pub_methods_classNet"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the network on some data.  <a href="#a3f711482dd39b9653f4449304b853a79">More...</a><br /></td></tr>
<tr class="separator:a3f711482dd39b9653f4449304b853a79 inherit pub_methods_classNet"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b4d9d5fcf5b31d2ae163cbe3f5b151f inherit pub_methods_classNet"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a5b4d9d5fcf5b31d2ae163cbe3f5b151f">test</a> (<a class="el" href="classExampleSet.html">ExampleSet</a> &amp;examples, int start=0, int num=-1)</td></tr>
<tr class="memdesc:a5b4d9d5fcf5b31d2ae163cbe3f5b151f inherit pub_methods_classNet"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test a network. Runs the network over a set of examples and returns the mean MSE for all outputs </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{1}{N\cdot N_{outs}}\sum^N_{e \in Examples} \sum_{i=0}^{N_{outs}} (e_o(i) - e_y(i))^2 \]" src="form_0.png"/>
</p>
<p> where <img class="formulaInl" alt="$N$" src="form_1.png"/> is the number of examples, <img class="formulaInl" alt="$N_{outs}$" src="form_2.png"/> is the number of outputs, <img class="formulaInl" alt="$e_o(i)$" src="form_3.png"/> is network's output for example <img class="formulaInl" alt="$e$" src="form_4.png"/>, and <img class="formulaInl" alt="$e_y(i)$" src="form_5.png"/> is the desired output for the same example.  <a href="#a5b4d9d5fcf5b31d2ae163cbe3f5b151f">More...</a><br /></td></tr>
<tr class="separator:a5b4d9d5fcf5b31d2ae163cbe3f5b151f inherit pub_methods_classNet"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e527a7773eed5fb071b78ef3a636c95 inherit pub_methods_classNet"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a4e527a7773eed5fb071b78ef3a636c95">trainSGD</a> (<a class="el" href="classExampleSet.html">ExampleSet</a> &amp;examples, <a class="el" href="structNet_1_1SGDParams.html">SGDParams</a> &amp;params)</td></tr>
<tr class="memdesc:a4e527a7773eed5fb071b78ef3a636c95 inherit pub_methods_classNet"><td class="mdescLeft">&#160;</td><td class="mdescRight">Train using stochastic gradient descent. Note that cross-validation parameters are slightly different from those given in the thesis. Here we give the number of slices and number of examples per slice; in the thesis we give the total number of examples to be held out and the number of slices.  <a href="#a4e527a7773eed5fb071b78ef3a636c95">More...</a><br /></td></tr>
<tr class="separator:a4e527a7773eed5fb071b78ef3a636c95 inherit pub_methods_classNet"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ad9b8ec22ef6319ebda7b3ac996b76f3e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#ad9b8ec22ef6319ebda7b3ac996b76f3e">BPNet</a> ()</td></tr>
<tr class="memdesc:ad9b8ec22ef6319ebda7b3ac996b76f3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Special constructor for subclasses which need to manipulate layer count before initialisation (e.g. <a class="el" href="classHInputNet.html" title="A modulatory network architecture which uses a plain backprop network with an extra input to carry th...">HInputNet</a>).  <a href="#ad9b8ec22ef6319ebda7b3ac996b76f3e">More...</a><br /></td></tr>
<tr class="separator:ad9b8ec22ef6319ebda7b3ac996b76f3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada480f784f72fb5de132ce368adde531"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#ada480f784f72fb5de132ce368adde531">init</a> (int nlayers, const int *layerCounts)</td></tr>
<tr class="memdesc:ada480f784f72fb5de132ce368adde531"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialiser for use by the main constructor and the ctors of those subclasses mentioned in <a class="el" href="classBPNet.html#ad9b8ec22ef6319ebda7b3ac996b76f3e" title="Special constructor for subclasses which need to manipulate layer count before initialisation (e...">BPNet()</a>  <a href="#ada480f784f72fb5de132ce368adde531">More...</a><br /></td></tr>
<tr class="separator:ada480f784f72fb5de132ce368adde531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1b90b3c92f6be9af29005371da66543"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#ae1b90b3c92f6be9af29005371da66543">initWeights</a> (double initr)</td></tr>
<tr class="memdesc:ae1b90b3c92f6be9af29005371da66543"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialise weights to random values  <a href="#ae1b90b3c92f6be9af29005371da66543">More...</a><br /></td></tr>
<tr class="separator:ae1b90b3c92f6be9af29005371da66543"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20f1696c6c5449b79101dc4f345e599e"><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a20f1696c6c5449b79101dc4f345e599e">getw</a> (int tolayer, int toneuron, int fromneuron) const </td></tr>
<tr class="memdesc:a20f1696c6c5449b79101dc4f345e599e"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the value of a weight.  <a href="#a20f1696c6c5449b79101dc4f345e599e">More...</a><br /></td></tr>
<tr class="separator:a20f1696c6c5449b79101dc4f345e599e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ffbe006ab858291ec96c503696c3131"><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a1ffbe006ab858291ec96c503696c3131">getb</a> (int layer, int neuron) const </td></tr>
<tr class="memdesc:a1ffbe006ab858291ec96c503696c3131"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the value of a bias  <a href="#a1ffbe006ab858291ec96c503696c3131">More...</a><br /></td></tr>
<tr class="separator:a1ffbe006ab858291ec96c503696c3131"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48d88671bda131e1a6d0baab080b6df6"><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a48d88671bda131e1a6d0baab080b6df6">getavggradw</a> (int tolayer, int toneuron, int fromneuron) const </td></tr>
<tr class="memdesc:a48d88671bda131e1a6d0baab080b6df6"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the value of the gradient for a given weight  <a href="#a48d88671bda131e1a6d0baab080b6df6">More...</a><br /></td></tr>
<tr class="separator:a48d88671bda131e1a6d0baab080b6df6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a916264dd0b58dcfae3d473231f7d0892"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a916264dd0b58dcfae3d473231f7d0892">getavggradb</a> (int l, int n) const </td></tr>
<tr class="memdesc:a916264dd0b58dcfae3d473231f7d0892"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the value of a bias gradient  <a href="#a916264dd0b58dcfae3d473231f7d0892">More...</a><br /></td></tr>
<tr class="separator:a916264dd0b58dcfae3d473231f7d0892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98e5db7247f0358375c27d1bb091f6ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a98e5db7247f0358375c27d1bb091f6ab">calcError</a> (double *in, double *out)</td></tr>
<tr class="memdesc:a98e5db7247f0358375c27d1bb091f6ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">run a single example and calculate the errors; used in training.  <a href="#a98e5db7247f0358375c27d1bb091f6ab">More...</a><br /></td></tr>
<tr class="separator:a98e5db7247f0358375c27d1bb091f6ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af60f5bfa6cb7dffd75a9a127b811a208"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#af60f5bfa6cb7dffd75a9a127b811a208">update</a> ()</td></tr>
<tr class="memdesc:af60f5bfa6cb7dffd75a9a127b811a208"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run a single update of the network.  <a href="#af60f5bfa6cb7dffd75a9a127b811a208">More...</a><br /></td></tr>
<tr class="separator:af60f5bfa6cb7dffd75a9a127b811a208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f820464f3338ed7305e9de950cd2103"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a3f820464f3338ed7305e9de950cd2103">trainBatch</a> (<a class="el" href="classExampleSet.html">ExampleSet</a> &amp;ex, int start, int num, double eta)</td></tr>
<tr class="memdesc:a3f820464f3338ed7305e9de950cd2103"><td class="mdescLeft">&#160;</td><td class="mdescRight">Train a network for batch (or mini-batch) (or single example).  <a href="#a3f820464f3338ed7305e9de950cd2103">More...</a><br /></td></tr>
<tr class="separator:a3f820464f3338ed7305e9de950cd2103"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classNet"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classNet')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classNet.html">Net</a></td></tr>
<tr class="memitem:a4bb31bf5599d954de2062747166b7dff inherit pro_methods_classNet"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a4bb31bf5599d954de2062747166b7dff">Net</a> (<a class="el" href="netType_8hpp.html#a1526df0fc932ccf720aa26267f923213">NetType</a> tp)</td></tr>
<tr class="memdesc:a4bb31bf5599d954de2062747166b7dff inherit pro_methods_classNet"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor - protected because others inherit it and it's not used directly.  <a href="#a4bb31bf5599d954de2062747166b7dff">More...</a><br /></td></tr>
<tr class="separator:a4bb31bf5599d954de2062747166b7dff inherit pro_methods_classNet"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aede931306b87045c0e6f14ee947a8ef7 inherit pro_methods_classNet"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#aede931306b87045c0e6f14ee947a8ef7">drand</a> (double mn, double mx)</td></tr>
<tr class="memdesc:aede931306b87045c0e6f14ee947a8ef7 inherit pro_methods_classNet"><td class="mdescLeft">&#160;</td><td class="mdescRight">get a random number using this net's PRNG data  <a href="#aede931306b87045c0e6f14ee947a8ef7">More...</a><br /></td></tr>
<tr class="separator:aede931306b87045c0e6f14ee947a8ef7 inherit pro_methods_classNet"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:aaabccfce85225083b21b02a3b3065c81"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#aaabccfce85225083b21b02a3b3065c81">numLayers</a></td></tr>
<tr class="memdesc:aaabccfce85225083b21b02a3b3065c81"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of layers, including input and output  <a href="#aaabccfce85225083b21b02a3b3065c81">More...</a><br /></td></tr>
<tr class="separator:aaabccfce85225083b21b02a3b3065c81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f59cc3cc5e0972d473e26a4fb47b5c6"><td class="memItemLeft" align="right" valign="top">int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a9f59cc3cc5e0972d473e26a4fb47b5c6">layerSizes</a></td></tr>
<tr class="memdesc:a9f59cc3cc5e0972d473e26a4fb47b5c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">array of layer sizes  <a href="#a9f59cc3cc5e0972d473e26a4fb47b5c6">More...</a><br /></td></tr>
<tr class="separator:a9f59cc3cc5e0972d473e26a4fb47b5c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60c06f158b82c2ee8a95df4f0c46235d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a60c06f158b82c2ee8a95df4f0c46235d">largestLayerSize</a></td></tr>
<tr class="memdesc:a60c06f158b82c2ee8a95df4f0c46235d"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of nodes in largest layer  <a href="#a60c06f158b82c2ee8a95df4f0c46235d">More...</a><br /></td></tr>
<tr class="separator:a60c06f158b82c2ee8a95df4f0c46235d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca57e8583a315a709a27e4dffeefd493"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#aca57e8583a315a709a27e4dffeefd493">weights</a></td></tr>
<tr class="memdesc:aca57e8583a315a709a27e4dffeefd493"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array of weights as [tolayer][tonode+largestLayerSize*fromnode].  <a href="#aca57e8583a315a709a27e4dffeefd493">More...</a><br /></td></tr>
<tr class="separator:aca57e8583a315a709a27e4dffeefd493"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e41caf79f495792d03395b0c3eea560"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a2e41caf79f495792d03395b0c3eea560">biases</a></td></tr>
<tr class="memdesc:a2e41caf79f495792d03395b0c3eea560"><td class="mdescLeft">&#160;</td><td class="mdescRight">array of biases, stored as a rectangular array of [layer][node]  <a href="#a2e41caf79f495792d03395b0c3eea560">More...</a><br /></td></tr>
<tr class="separator:a2e41caf79f495792d03395b0c3eea560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2839f081e9f715b207fcc89789bfd0a"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#af2839f081e9f715b207fcc89789bfd0a">outputs</a></td></tr>
<tr class="memdesc:af2839f081e9f715b207fcc89789bfd0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">outputs of each layer: one array of doubles for each  <a href="#af2839f081e9f715b207fcc89789bfd0a">More...</a><br /></td></tr>
<tr class="separator:af2839f081e9f715b207fcc89789bfd0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b60b49ea0c157bbe4d785f74fa3f208"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a6b60b49ea0c157bbe4d785f74fa3f208">errors</a></td></tr>
<tr class="memdesc:a6b60b49ea0c157bbe4d785f74fa3f208"><td class="mdescLeft">&#160;</td><td class="mdescRight">the error for each node, calculated by <a class="el" href="classBPNet.html#a98e5db7247f0358375c27d1bb091f6ab" title="run a single example and calculate the errors; used in training. ">calcError()</a>  <a href="#a6b60b49ea0c157bbe4d785f74fa3f208">More...</a><br /></td></tr>
<tr class="separator:a6b60b49ea0c157bbe4d785f74fa3f208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72567d85f25041df70225b5e98ae3b90"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a72567d85f25041df70225b5e98ae3b90">gradAvgsWeights</a></td></tr>
<tr class="memdesc:a72567d85f25041df70225b5e98ae3b90"><td class="mdescLeft">&#160;</td><td class="mdescRight">average gradient for each weight (built during training)  <a href="#a72567d85f25041df70225b5e98ae3b90">More...</a><br /></td></tr>
<tr class="separator:a72567d85f25041df70225b5e98ae3b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e9fb8bde12a2520186d8084628109b"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBPNet.html#a90e9fb8bde12a2520186d8084628109b">gradAvgsBiases</a></td></tr>
<tr class="memdesc:a90e9fb8bde12a2520186d8084628109b"><td class="mdescLeft">&#160;</td><td class="mdescRight">average gradient for each bias (built during training)  <a href="#a90e9fb8bde12a2520186d8084628109b">More...</a><br /></td></tr>
<tr class="separator:a90e9fb8bde12a2520186d8084628109b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_attribs_classNet"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classNet')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classNet.html">Net</a></td></tr>
<tr class="memitem:a6b6b0fb9e01f10084ce304df6d8c841d inherit pub_attribs_classNet"><td class="memItemLeft" align="right" valign="top"><a class="el" href="netType_8hpp.html#a1526df0fc932ccf720aa26267f923213">NetType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a6b6b0fb9e01f10084ce304df6d8c841d">type</a></td></tr>
<tr class="memdesc:a6b6b0fb9e01f10084ce304df6d8c841d inherit pub_attribs_classNet"><td class="mdescLeft">&#160;</td><td class="mdescRight">type of the network, used for load/save  <a href="#a6b6b0fb9e01f10084ce304df6d8c841d">More...</a><br /></td></tr>
<tr class="separator:a6b6b0fb9e01f10084ce304df6d8c841d inherit pub_attribs_classNet"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a364288d09aeae0b47c5adbfb470a6c1c inherit pub_attribs_classNet"><td class="memItemLeft" align="right" valign="top">drand48_data&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a364288d09aeae0b47c5adbfb470a6c1c">rd</a></td></tr>
<tr class="memdesc:a364288d09aeae0b47c5adbfb470a6c1c inherit pub_attribs_classNet"><td class="mdescLeft">&#160;</td><td class="mdescRight">PRNG data (thread safe)  <a href="#a364288d09aeae0b47c5adbfb470a6c1c">More...</a><br /></td></tr>
<tr class="separator:a364288d09aeae0b47c5adbfb470a6c1c inherit pub_attribs_classNet"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The "basic" back-propagation network using a logistic sigmoid, as described by Rumelhart, Hinton and Williams (and many others). This class is used by output blending and h-as-input networks. </p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00018">18</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ad9b8ec22ef6319ebda7b3ac996b76f3e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">BPNet::BPNet </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Special constructor for subclasses which need to manipulate layer count before initialisation (e.g. <a class="el" href="classHInputNet.html" title="A modulatory network architecture which uses a plain backprop network with an extra input to carry th...">HInputNet</a>). </p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00024">24</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="acc0ad3e9fb7c706a4bc8676b3aaf47b8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">BPNet::BPNet </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>layerCounts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor - does not initialise the weights to random values so that we can reinitialise networks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nlayers</td><td>number of layers </td></tr>
    <tr><td class="paramname">layerCounts</td><td>array of layer counts </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00069">69</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7a452b3f05cc7e72b897a3546a38c010"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual BPNet::~BPNet </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>destructor </p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00086">86</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a98e5db7247f0358375c27d1bb091f6ab"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void BPNet::calcError </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>run a single example and calculate the errors; used in training. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>inputs </td></tr>
    <tr><td class="paramname">out</td><td>required outputs </td></tr>
  </table>
  </dd>
</dl>
<dl class="section post"><dt>Postcondition</dt><dd>the errors will be in the errors variable </dd></dl>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00294">294</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a916264dd0b58dcfae3d473231f7d0892"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double BPNet::getavggradb </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get the value of a bias gradient </p>
<dl class="section pre"><dt>Precondition</dt><dd>gradients must have been calculated as part of training step </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">l</td><td>index of layer </td></tr>
    <tr><td class="paramname">n</td><td>index of neuron within layer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00283">283</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a48d88671bda131e1a6d0baab080b6df6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double&amp; BPNet::getavggradw </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tolayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>toneuron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromneuron</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get the value of the gradient for a given weight </p>
<dl class="section pre"><dt>Precondition</dt><dd>gradients must have been calculated as part of training step </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tolayer</td><td>the layer of the destination node (from is assumed to be previous layer) </td></tr>
    <tr><td class="paramname">toneuron</td><td>the index of the destination node in that layer </td></tr>
    <tr><td class="paramname">fromneuron</td><td>the index of the source node </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00272">272</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a1ffbe006ab858291ec96c503696c3131"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double&amp; BPNet::getb </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>neuron</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get the value of a bias </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>index of layer </td></tr>
    <tr><td class="paramname">neuron</td><td>index of neuron within layer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00259">259</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab0071a9b17ba5d42959ce600d29a255c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int BPNet::getDataSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the length of the serialised data block for this network. </p>
<dl class="section return"><dt>Returns</dt><dd>the size in doubles </dd></dl>

<p>Implements <a class="el" href="classNet.html#a18dfc4bbf338d5167e787edefef8cd43">Net</a>.</p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00134">134</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="aef1082e622022f25bee51013fab29aa0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double BPNet::getH </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get the modulator level </p>

<p>Implements <a class="el" href="classNet.html#afc3db6d4a7b1307b359f98da0b9b3bf2">Net</a>.</p>

<p>Reimplemented in <a class="el" href="classHInputNet.html#aa79dc2d56582978e28661e0f6163d163">HInputNet</a>, and <a class="el" href="classUESNet.html#a421efc8741f28e65931e2b8affa7c149">UESNet</a>.</p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00077">77</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="af52311c47d488b0121ea59574e2b9c05"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int BPNet::getLayerCount </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the number of layers. </p>

<p>Implements <a class="el" href="classNet.html#a84682330293fe317a8b483eed2987939">Net</a>.</p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00128">128</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="afbf10480c672d8a6e3cbf4071f447cc8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int BPNet::getLayerSize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the number of nodes in a given layer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>layer number </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classNet.html#a01aa05702b4cc818b9ae860675a6b219">Net</a>.</p>

<p>Reimplemented in <a class="el" href="classHInputNet.html#a70a98f13c5a0ee60aaa28438dfc734f8">HInputNet</a>.</p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00124">124</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="adf9256df2239cdef0cb7ad3b45d0e06e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double* BPNet::getOutputs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the outputs after running. </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to the output layer outputs </dd></dl>

<p>Implements <a class="el" href="classNet.html#a38d901e18a4a269ca7ed3766cc4b4079">Net</a>.</p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00120">120</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a20f1696c6c5449b79101dc4f345e599e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double&amp; BPNet::getw </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tolayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>toneuron</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fromneuron</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get the value of a weight. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tolayer</td><td>the layer of the destination node (from is assumed to be previous layer) </td></tr>
    <tr><td class="paramname">toneuron</td><td>the index of the destination node in that layer </td></tr>
    <tr><td class="paramname">fromneuron</td><td>the index of the source node </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00249">249</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ada480f784f72fb5de132ce368adde531"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void BPNet::init </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>layerCounts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialiser for use by the main constructor and the ctors of those subclasses mentioned in <a class="el" href="classBPNet.html#ad9b8ec22ef6319ebda7b3ac996b76f3e" title="Special constructor for subclasses which need to manipulate layer count before initialisation (e...">BPNet()</a> </p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00032">32</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae1b90b3c92f6be9af29005371da66543"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void BPNet::initWeights </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>initr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>initialise weights to random values </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">initr</td><td>range of weights [-n,n], or -1 for Bishop's rule. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classNet.html#a5bbf19d2255b0c8418c9bd54930290cf">Net</a>.</p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00218">218</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a11724f2263de9dcbc0f9172b464732c7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void BPNet::load </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Given that the pointer points to a data block of the correct size for the current network, copy the parameters from that data block into the current network overwriting the current parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>the buffer to load the data from, must be at least <a class="el" href="classBPNet.html#ab0071a9b17ba5d42959ce600d29a255c" title="Get the length of the serialised data block for this network. ">getDataSize()</a> doubles </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classNet.html#a6fc4cac6c8e32acc1d3567defcce9b8c">Net</a>.</p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00170">170</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7ef14370548350daecedcb275ba88c07"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void BPNet::save </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Serialize the data (not including any network type magic number or layer/node counts) to the given memory (which must be of sufficient size). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>the buffer to save the data, must be at least <a class="el" href="classBPNet.html#ab0071a9b17ba5d42959ce600d29a255c" title="Get the length of the serialised data block for this network. ">getDataSize()</a> doubles </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classNet.html#ad1178bdda5ebb1dc1bb57dc3da727fce">Net</a>.</p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00151">151</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a98fa374aec169a3e741f2ce96fac7094"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void BPNet::setH </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the modulator level for subsequent runs and training of this network. </p>

<p>Implements <a class="el" href="classNet.html#a5a01870e21e29845252d6bec88b0c497">Net</a>.</p>

<p>Reimplemented in <a class="el" href="classHInputNet.html#a3ac18a3e39fc58647052518e507ae378">HInputNet</a>, and <a class="el" href="classUESNet.html#ad05de4582dd40ae714fce3f9b0d3d2ca">UESNet</a>.</p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00073">73</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae9e80dbedb62e973efdef21745a4a27a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void BPNet::setInput </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Used to set inputs manually, typically in <a class="el" href="classHInputNet.html" title="A modulatory network architecture which uses a plain backprop network with an extra input to carry th...">HInputNet</a>. </p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00115">115</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad95c2a033ee8246637a6ce55e685429a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void BPNet::setInputs </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the inputs to the network before running or training. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>array of doubles, the size of the input layer </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classNet.html#a3c41ce6877aa3b04e5c19943bc78d007">Net</a>.</p>

<p>Reimplemented in <a class="el" href="classHInputNet.html#a2c463ec5781f9e84865747e8bb085065">HInputNet</a>.</p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00104">104</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3f820464f3338ed7305e9de950cd2103"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double BPNet::trainBatch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classExampleSet.html">ExampleSet</a> &amp;&#160;</td>
          <td class="paramname"><em>ex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Train a network for batch (or mini-batch) (or single example). </p>
<p>This will</p><ul>
<li>zero the average gradient variables for all weights and biases</li>
<li>zero the total error</li>
<li>for each example<ul>
<li>calculate the error with <a class="el" href="classBPNet.html#a98e5db7247f0358375c27d1bb091f6ab" title="run a single example and calculate the errors; used in training. ">calcError()</a> which itself calls <a class="el" href="classBPNet.html#af60f5bfa6cb7dffd75a9a127b811a208" title="Run a single update of the network. ">update()</a></li>
<li>add to the total mean squared error (see NOTE below)</li>
</ul>
</li>
<li>for each weight and bias<ul>
<li>calculate the means across all provided examples</li>
<li>apply the mean to the weight or bias</li>
</ul>
</li>
<li>return the mean squared error (NOTE: different from original, which returned mean absolute error) for all outputs and examples: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{1}{N\cdot N_{outs}}\sum^N_{e \in Examples} \sum_{i=0}^{N_{outs}} (e_o(i) - e_y(i))^2 \]" src="form_0.png"/>
</p>
 where <img class="formulaInl" alt="$N$" src="form_1.png"/> is the number of examples, <img class="formulaInl" alt="$N_{outs}$" src="form_2.png"/> is the number of outputs, <img class="formulaInl" alt="$e_o(i)$" src="form_3.png"/> is network's output for example <img class="formulaInl" alt="$e$" src="form_4.png"/>, and <img class="formulaInl" alt="$e_y(i)$" src="form_5.png"/> is the desired output for the same example. <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ex</td><td>example set </td></tr>
    <tr><td class="paramname">start</td><td>index of first example to use </td></tr>
    <tr><td class="paramname">num</td><td>number of examples. For a single example, you'd just use 1. </td></tr>
    <tr><td class="paramname">eta</td><td>learning rate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the sum of mean squared errors in the output layer (see formula in method documentation) </dd></dl>
</li>
</ul>

<p>Implements <a class="el" href="classNet.html#a6ac1fa9f916aa77906581af9140b8175">Net</a>.</p>

<p>Reimplemented in <a class="el" href="classUESNet.html#ac27da7319d8be1507ea80506e69437e5">UESNet</a>.</p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00332">332</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="af60f5bfa6cb7dffd75a9a127b811a208"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void BPNet::update </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run a single update of the network. </p>
<dl class="section pre"><dt>Precondition</dt><dd>input layer must be filled with values </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>output layer contains result </dd></dl>

<p>Implements <a class="el" href="classNet.html#ad02198e219d3ba060c88d764ce54b905">Net</a>.</p>

<p>Reimplemented in <a class="el" href="classUESNet.html#a1d05fcd3ce9f188db8841a9d6fc6c56c">UESNet</a>.</p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00320">320</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a2e41caf79f495792d03395b0c3eea560"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** BPNet::biases</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>array of biases, stored as a rectangular array of [layer][node] </p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00208">208</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6b60b49ea0c157bbe4d785f74fa3f208"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** BPNet::errors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the error for each node, calculated by <a class="el" href="classBPNet.html#a98e5db7247f0358375c27d1bb091f6ab" title="run a single example and calculate the errors; used in training. ">calcError()</a> </p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00213">213</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a90e9fb8bde12a2520186d8084628109b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** BPNet::gradAvgsBiases</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>average gradient for each bias (built during training) </p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00216">216</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a72567d85f25041df70225b5e98ae3b90"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** BPNet::gradAvgsWeights</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>average gradient for each weight (built during training) </p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00215">215</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a60c06f158b82c2ee8a95df4f0c46235d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int BPNet::largestLayerSize</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>number of nodes in largest layer </p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00192">192</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9f59cc3cc5e0972d473e26a4fb47b5c6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int* BPNet::layerSizes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>array of layer sizes </p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00191">191</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="aaabccfce85225083b21b02a3b3065c81"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int BPNet::numLayers</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>number of layers, including input and output </p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00190">190</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="af2839f081e9f715b207fcc89789bfd0a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** BPNet::outputs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>outputs of each layer: one array of doubles for each </p>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00212">212</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="aca57e8583a315a709a27e4dffeefd493"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** BPNet::weights</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Array of weights as [tolayer][tonode+largestLayerSize*fromnode]. </p>
<p>Weights are stored as a square matrix, even though less than half is used. Less than that, if not all layers are the same size, since the dimension of the matrix must be the size of the largest layer. Each array has its own matrix, so index by [layer][i+largestLayerSize*j], where</p><ul>
<li>layer is the "TO" layer</li>
<li>layer-1 is the FROM layer</li>
<li>i is the TO neuron (i.e. the end of the connection)</li>
<li>j is the FROM neuron (the start) </li>
</ul>

<p>Definition at line <a class="el" href="bpnet_8hpp_source.html#l00205">205</a> of file <a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/travis/build/jimfinnis/uesmanncpp/<a class="el" href="bpnet_8hpp_source.html">bpnet.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
