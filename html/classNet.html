<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>UESMANN CPP: Net Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UESMANN CPP
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Reference implementation of UESMANN</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classNet-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Net Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>The abstract network type upon which all others are based. It's not pure virtual, in that it encapsulates some high level operations (such as the top-level training algorithm).  
 <a href="classNet.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="net_8hpp_source.html">net.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Net:</div>
<div class="dyncontent">
<div class="center"><img src="classNet__inherit__graph.png" border="0" usemap="#Net_inherit__map" alt="Inheritance graph"/></div>
<map name="Net_inherit__map" id="Net_inherit__map">
<area shape="rect" id="node2" href="classBPNet.html" title="The &quot;basic&quot; back&#45;propagation network using a logistic sigmoid, as described by Rumelhart, Hinton and Williams (and many others). This class is used by output blending and h&#45;as&#45;input networks. " alt="" coords="67,80,128,107"/>
<area shape="rect" id="node5" href="classOutputBlendingNet.html" title="A modulatory network architecture which uses two plain backprop networks, each of which is trained se..." alt="" coords="153,80,285,107"/>
<area shape="rect" id="node3" href="classHInputNet.html" title="A modulatory network architecture which uses a plain backprop network with an extra input to carry th..." alt="" coords="5,155,88,181"/>
<area shape="rect" id="node4" href="classUESNet.html" title="The UESMANN network, which it itself based on the BPNet code as it has the same architecture as the p..." alt="" coords="113,155,183,181"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structNet_1_1SGDParams.html">SGDParams</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Training parameters for <a class="el" href="classNet.html#a4e527a7773eed5fb071b78ef3a636c95" title="Train using stochastic gradient descent. Note that cross-validation parameters are slightly different...">trainSGD()</a>. This structure holds the parameters for the <a class="el" href="classNet.html#a4e527a7773eed5fb071b78ef3a636c95" title="Train using stochastic gradient descent. Note that cross-validation parameters are slightly different...">trainSGD()</a> method, and serves as a better way of passing them than a long parameter list. All values have defaults set up by the constructor, which are given as constants. You can set parameters by hand, but there are fluent (chainable) setters for many members.  <a href="structNet_1_1SGDParams.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a882ce3a3037e5fe06f1a11f87cb0629d"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a882ce3a3037e5fe06f1a11f87cb0629d">~Net</a> ()</td></tr>
<tr class="memdesc:a882ce3a3037e5fe06f1a11f87cb0629d"><td class="mdescLeft">&#160;</td><td class="mdescRight">virtual destructor which does nothing  <a href="#a882ce3a3037e5fe06f1a11f87cb0629d">More...</a><br /></td></tr>
<tr class="separator:a882ce3a3037e5fe06f1a11f87cb0629d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ef424e05bfeff073bbca57a5735c121"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a2ef424e05bfeff073bbca57a5735c121">setSeed</a> (long seed)</td></tr>
<tr class="memdesc:a2ef424e05bfeff073bbca57a5735c121"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set this network's random number generator, which is used for weight initialisation done at the start of training.  <a href="#a2ef424e05bfeff073bbca57a5735c121">More...</a><br /></td></tr>
<tr class="separator:a2ef424e05bfeff073bbca57a5735c121"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01aa05702b4cc818b9ae860675a6b219"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a01aa05702b4cc818b9ae860675a6b219">getLayerSize</a> (int n) const =0</td></tr>
<tr class="memdesc:a01aa05702b4cc818b9ae860675a6b219"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of nodes in a given layer.  <a href="#a01aa05702b4cc818b9ae860675a6b219">More...</a><br /></td></tr>
<tr class="separator:a01aa05702b4cc818b9ae860675a6b219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84682330293fe317a8b483eed2987939"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a84682330293fe317a8b483eed2987939">getLayerCount</a> () const =0</td></tr>
<tr class="memdesc:a84682330293fe317a8b483eed2987939"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the number of layers.  <a href="#a84682330293fe317a8b483eed2987939">More...</a><br /></td></tr>
<tr class="separator:a84682330293fe317a8b483eed2987939"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53df5c1c5703b73ee5a7ccb7537b66a9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a53df5c1c5703b73ee5a7ccb7537b66a9">getInputCount</a> () const </td></tr>
<tr class="memdesc:a53df5c1c5703b73ee5a7ccb7537b66a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the number of inputs  <a href="#a53df5c1c5703b73ee5a7ccb7537b66a9">More...</a><br /></td></tr>
<tr class="separator:a53df5c1c5703b73ee5a7ccb7537b66a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f96e2ae07bec62b8c97ab192528f3c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a5f96e2ae07bec62b8c97ab192528f3c3">getOutputCount</a> () const </td></tr>
<tr class="memdesc:a5f96e2ae07bec62b8c97ab192528f3c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the number of outputs  <a href="#a5f96e2ae07bec62b8c97ab192528f3c3">More...</a><br /></td></tr>
<tr class="separator:a5f96e2ae07bec62b8c97ab192528f3c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c41ce6877aa3b04e5c19943bc78d007"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a3c41ce6877aa3b04e5c19943bc78d007">setInputs</a> (double *d)=0</td></tr>
<tr class="memdesc:a3c41ce6877aa3b04e5c19943bc78d007"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the inputs to the network before running or training.  <a href="#a3c41ce6877aa3b04e5c19943bc78d007">More...</a><br /></td></tr>
<tr class="separator:a3c41ce6877aa3b04e5c19943bc78d007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38d901e18a4a269ca7ed3766cc4b4079"><td class="memItemLeft" align="right" valign="top">virtual double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a38d901e18a4a269ca7ed3766cc4b4079">getOutputs</a> () const =0</td></tr>
<tr class="memdesc:a38d901e18a4a269ca7ed3766cc4b4079"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the outputs after running.  <a href="#a38d901e18a4a269ca7ed3766cc4b4079">More...</a><br /></td></tr>
<tr class="separator:a38d901e18a4a269ca7ed3766cc4b4079"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f711482dd39b9653f4449304b853a79"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a3f711482dd39b9653f4449304b853a79">run</a> (double *in)</td></tr>
<tr class="memdesc:a3f711482dd39b9653f4449304b853a79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the network on some data.  <a href="#a3f711482dd39b9653f4449304b853a79">More...</a><br /></td></tr>
<tr class="separator:a3f711482dd39b9653f4449304b853a79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a01870e21e29845252d6bec88b0c497"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a5a01870e21e29845252d6bec88b0c497">setH</a> (double h)=0</td></tr>
<tr class="memdesc:a5a01870e21e29845252d6bec88b0c497"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the modulator level for subsequent runs and training of this network.  <a href="#a5a01870e21e29845252d6bec88b0c497">More...</a><br /></td></tr>
<tr class="separator:a5a01870e21e29845252d6bec88b0c497"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc3db6d4a7b1307b359f98da0b9b3bf2"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#afc3db6d4a7b1307b359f98da0b9b3bf2">getH</a> () const =0</td></tr>
<tr class="memdesc:afc3db6d4a7b1307b359f98da0b9b3bf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the modulator level  <a href="#afc3db6d4a7b1307b359f98da0b9b3bf2">More...</a><br /></td></tr>
<tr class="separator:afc3db6d4a7b1307b359f98da0b9b3bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b4d9d5fcf5b31d2ae163cbe3f5b151f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a5b4d9d5fcf5b31d2ae163cbe3f5b151f">test</a> (<a class="el" href="classExampleSet.html">ExampleSet</a> &amp;examples, int start=0, int num=-1)</td></tr>
<tr class="memdesc:a5b4d9d5fcf5b31d2ae163cbe3f5b151f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test a network. Runs the network over a set of examples and returns the mean MSE for all outputs </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{1}{N\cdot N_{outs}}\sum^N_{e \in Examples} \sum_{i=0}^{N_{outs}} (e_o(i) - e_y(i))^2 \]" src="form_0.png"/>
</p>
<p> where <img class="formulaInl" alt="$N$" src="form_1.png"/> is the number of examples, <img class="formulaInl" alt="$N_{outs}$" src="form_2.png"/> is the number of outputs, <img class="formulaInl" alt="$e_o(i)$" src="form_3.png"/> is network's output for example <img class="formulaInl" alt="$e$" src="form_4.png"/>, and <img class="formulaInl" alt="$e_y(i)$" src="form_5.png"/> is the desired output for the same example.  <a href="#a5b4d9d5fcf5b31d2ae163cbe3f5b151f">More...</a><br /></td></tr>
<tr class="separator:a5b4d9d5fcf5b31d2ae163cbe3f5b151f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e527a7773eed5fb071b78ef3a636c95"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a4e527a7773eed5fb071b78ef3a636c95">trainSGD</a> (<a class="el" href="classExampleSet.html">ExampleSet</a> &amp;examples, <a class="el" href="structNet_1_1SGDParams.html">SGDParams</a> &amp;params)</td></tr>
<tr class="memdesc:a4e527a7773eed5fb071b78ef3a636c95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Train using stochastic gradient descent. Note that cross-validation parameters are slightly different from those given in the thesis. Here we give the number of slices and number of examples per slice; in the thesis we give the total number of examples to be held out and the number of slices.  <a href="#a4e527a7773eed5fb071b78ef3a636c95">More...</a><br /></td></tr>
<tr class="separator:a4e527a7773eed5fb071b78ef3a636c95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18dfc4bbf338d5167e787edefef8cd43"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a18dfc4bbf338d5167e787edefef8cd43">getDataSize</a> () const =0</td></tr>
<tr class="memdesc:a18dfc4bbf338d5167e787edefef8cd43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the length of the serialised data block for this network.  <a href="#a18dfc4bbf338d5167e787edefef8cd43">More...</a><br /></td></tr>
<tr class="separator:a18dfc4bbf338d5167e787edefef8cd43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1178bdda5ebb1dc1bb57dc3da727fce"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#ad1178bdda5ebb1dc1bb57dc3da727fce">save</a> (double *buf) const =0</td></tr>
<tr class="memdesc:ad1178bdda5ebb1dc1bb57dc3da727fce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize the data (not including any network type magic number or layer/node counts) to the given memory (which must be of sufficient size).  <a href="#ad1178bdda5ebb1dc1bb57dc3da727fce">More...</a><br /></td></tr>
<tr class="separator:ad1178bdda5ebb1dc1bb57dc3da727fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fc4cac6c8e32acc1d3567defcce9b8c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a6fc4cac6c8e32acc1d3567defcce9b8c">load</a> (double *buf)=0</td></tr>
<tr class="memdesc:a6fc4cac6c8e32acc1d3567defcce9b8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given that the pointer points to a data block of the correct size for the current network, copy the parameters from that data block into the current network overwriting the current parameters.  <a href="#a6fc4cac6c8e32acc1d3567defcce9b8c">More...</a><br /></td></tr>
<tr class="separator:a6fc4cac6c8e32acc1d3567defcce9b8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a6b6b0fb9e01f10084ce304df6d8c841d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="netType_8hpp.html#a1526df0fc932ccf720aa26267f923213">NetType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a6b6b0fb9e01f10084ce304df6d8c841d">type</a></td></tr>
<tr class="memdesc:a6b6b0fb9e01f10084ce304df6d8c841d"><td class="mdescLeft">&#160;</td><td class="mdescRight">type of the network, used for load/save  <a href="#a6b6b0fb9e01f10084ce304df6d8c841d">More...</a><br /></td></tr>
<tr class="separator:a6b6b0fb9e01f10084ce304df6d8c841d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a364288d09aeae0b47c5adbfb470a6c1c"><td class="memItemLeft" align="right" valign="top">drand48_data&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a364288d09aeae0b47c5adbfb470a6c1c">rd</a></td></tr>
<tr class="memdesc:a364288d09aeae0b47c5adbfb470a6c1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">PRNG data (thread safe)  <a href="#a364288d09aeae0b47c5adbfb470a6c1c">More...</a><br /></td></tr>
<tr class="separator:a364288d09aeae0b47c5adbfb470a6c1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ad02198e219d3ba060c88d764ce54b905"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#ad02198e219d3ba060c88d764ce54b905">update</a> ()=0</td></tr>
<tr class="memdesc:ad02198e219d3ba060c88d764ce54b905"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run a single update of the network.  <a href="#ad02198e219d3ba060c88d764ce54b905">More...</a><br /></td></tr>
<tr class="separator:ad02198e219d3ba060c88d764ce54b905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bb31bf5599d954de2062747166b7dff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a4bb31bf5599d954de2062747166b7dff">Net</a> (<a class="el" href="netType_8hpp.html#a1526df0fc932ccf720aa26267f923213">NetType</a> tp)</td></tr>
<tr class="memdesc:a4bb31bf5599d954de2062747166b7dff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor - protected because others inherit it and it's not used directly.  <a href="#a4bb31bf5599d954de2062747166b7dff">More...</a><br /></td></tr>
<tr class="separator:a4bb31bf5599d954de2062747166b7dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aede931306b87045c0e6f14ee947a8ef7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#aede931306b87045c0e6f14ee947a8ef7">drand</a> (double mn, double mx)</td></tr>
<tr class="memdesc:aede931306b87045c0e6f14ee947a8ef7"><td class="mdescLeft">&#160;</td><td class="mdescRight">get a random number using this net's PRNG data  <a href="#aede931306b87045c0e6f14ee947a8ef7">More...</a><br /></td></tr>
<tr class="separator:aede931306b87045c0e6f14ee947a8ef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bbf19d2255b0c8418c9bd54930290cf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a5bbf19d2255b0c8418c9bd54930290cf">initWeights</a> (double initr)=0</td></tr>
<tr class="memdesc:a5bbf19d2255b0c8418c9bd54930290cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialise weights to random values  <a href="#a5bbf19d2255b0c8418c9bd54930290cf">More...</a><br /></td></tr>
<tr class="separator:a5bbf19d2255b0c8418c9bd54930290cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ac1fa9f916aa77906581af9140b8175"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a6ac1fa9f916aa77906581af9140b8175">trainBatch</a> (<a class="el" href="classExampleSet.html">ExampleSet</a> &amp;ex, int start, int num, double eta)=0</td></tr>
<tr class="memdesc:a6ac1fa9f916aa77906581af9140b8175"><td class="mdescLeft">&#160;</td><td class="mdescRight">Train a network for batch (or mini-batch) (or single example).  <a href="#a6ac1fa9f916aa77906581af9140b8175">More...</a><br /></td></tr>
<tr class="separator:a6ac1fa9f916aa77906581af9140b8175"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a9ffff8d20e4d424b4358f43e204c7d1b"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a9ffff8d20e4d424b4358f43e204c7d1b">OutputBlendingNet</a></td></tr>
<tr class="separator:a9ffff8d20e4d424b4358f43e204c7d1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e75331604ab50e15c580aeb31b3804f"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNet.html#a8e75331604ab50e15c580aeb31b3804f">HInputNet</a></td></tr>
<tr class="separator:a8e75331604ab50e15c580aeb31b3804f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The abstract network type upon which all others are based. It's not pure virtual, in that it encapsulates some high level operations (such as the top-level training algorithm). </p>

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00039">39</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a882ce3a3037e5fe06f1a11f87cb0629d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual Net::~Net </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>virtual destructor which does nothing </p>

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00047">47</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4bb31bf5599d954de2062747166b7dff"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Net::Net </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="netType_8hpp.html#a1526df0fc932ccf720aa26267f923213">NetType</a>&#160;</td>
          <td class="paramname"><em>tp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor - protected because others inherit it and it's not used directly. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tp</td><td>network type enumeration </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00580">580</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aede931306b87045c0e6f14ee947a8ef7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double Net::drand </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get a random number using this net's PRNG data </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mn</td><td>minimum value (inclusive) </td></tr>
    <tr><td class="paramname">mx</td><td>maximum value (inclusive) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00591">591</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a18dfc4bbf338d5167e787edefef8cd43"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int Net::getDataSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the length of the serialised data block for this network. </p>
<dl class="section return"><dt>Returns</dt><dd>the size in doubles </dd></dl>

<p>Implemented in <a class="el" href="classBPNet.html#ab0071a9b17ba5d42959ce600d29a255c">BPNet</a>, and <a class="el" href="classOutputBlendingNet.html#a1196e5ab4cc8326308395d91f7128454">OutputBlendingNet</a>.</p>

</div>
</div>
<a class="anchor" id="afc3db6d4a7b1307b359f98da0b9b3bf2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double Net::getH </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get the modulator level </p>

<p>Implemented in <a class="el" href="classBPNet.html#aef1082e622022f25bee51013fab29aa0">BPNet</a>, <a class="el" href="classHInputNet.html#aa79dc2d56582978e28661e0f6163d163">HInputNet</a>, <a class="el" href="classOutputBlendingNet.html#a1d8ff29c1f29c431df31f9e22c89d529">OutputBlendingNet</a>, and <a class="el" href="classUESNet.html#a421efc8741f28e65931e2b8affa7c149">UESNet</a>.</p>

</div>
</div>
<a class="anchor" id="a53df5c1c5703b73ee5a7ccb7537b66a9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Net::getInputCount </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get the number of inputs </p>

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00075">75</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a84682330293fe317a8b483eed2987939"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int Net::getLayerCount </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the number of layers. </p>

<p>Implemented in <a class="el" href="classBPNet.html#af52311c47d488b0121ea59574e2b9c05">BPNet</a>, and <a class="el" href="classOutputBlendingNet.html#ade2a917996b0325fd4b23d1584645d1a">OutputBlendingNet</a>.</p>

</div>
</div>
<a class="anchor" id="a01aa05702b4cc818b9ae860675a6b219"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int Net::getLayerSize </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the number of nodes in a given layer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>layer number </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classBPNet.html#afbf10480c672d8a6e3cbf4071f447cc8">BPNet</a>, <a class="el" href="classHInputNet.html#a70a98f13c5a0ee60aaa28438dfc734f8">HInputNet</a>, and <a class="el" href="classOutputBlendingNet.html#ad31f525182b2949d406a203189b65ae8">OutputBlendingNet</a>.</p>

</div>
</div>
<a class="anchor" id="a5f96e2ae07bec62b8c97ab192528f3c3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Net::getOutputCount </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>get the number of outputs </p>

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00082">82</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a38d901e18a4a269ca7ed3766cc4b4079"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double* Net::getOutputs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the outputs after running. </p>
<dl class="section return"><dt>Returns</dt><dd>pointer to the output layer outputs </dd></dl>

<p>Implemented in <a class="el" href="classBPNet.html#adf9256df2239cdef0cb7ad3b45d0e06e">BPNet</a>, and <a class="el" href="classOutputBlendingNet.html#a6ea58b1ae8d0f5e6ff3b0f616de63eb5">OutputBlendingNet</a>.</p>

</div>
</div>
<a class="anchor" id="a5bbf19d2255b0c8418c9bd54930290cf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Net::initWeights </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>initr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>initialise weights to random values </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">initr</td><td>range of weights [-n,n], or -1 for Bishop's rule. </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classBPNet.html#ae1b90b3c92f6be9af29005371da66543">BPNet</a>, and <a class="el" href="classOutputBlendingNet.html#abb65aa0c88e2e29a17b4f91e1c6d7b03">OutputBlendingNet</a>.</p>

</div>
</div>
<a class="anchor" id="a6fc4cac6c8e32acc1d3567defcce9b8c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Net::load </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Given that the pointer points to a data block of the correct size for the current network, copy the parameters from that data block into the current network overwriting the current parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>the buffer to load the data from, must be at least <a class="el" href="classNet.html#a18dfc4bbf338d5167e787edefef8cd43" title="Get the length of the serialised data block for this network. ">getDataSize()</a> doubles </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classBPNet.html#a11724f2263de9dcbc0f9172b464732c7">BPNet</a>, and <a class="el" href="classOutputBlendingNet.html#a97c9054693c98b2771763b38c5576d47">OutputBlendingNet</a>.</p>

</div>
</div>
<a class="anchor" id="a3f711482dd39b9653f4449304b853a79"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* Net::run </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run the network on some data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>pointer to the input double array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the output double array </dd></dl>

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00107">107</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad1178bdda5ebb1dc1bb57dc3da727fce"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Net::save </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Serialize the data (not including any network type magic number or layer/node counts) to the given memory (which must be of sufficient size). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>the buffer to save the data, must be at least <a class="el" href="classNet.html#a18dfc4bbf338d5167e787edefef8cd43" title="Get the length of the serialised data block for this network. ">getDataSize()</a> doubles </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classBPNet.html#a7ef14370548350daecedcb275ba88c07">BPNet</a>, and <a class="el" href="classOutputBlendingNet.html#a9520621635c8b05d472be9185a341475">OutputBlendingNet</a>.</p>

</div>
</div>
<a class="anchor" id="a5a01870e21e29845252d6bec88b0c497"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Net::setH </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the modulator level for subsequent runs and training of this network. </p>

<p>Implemented in <a class="el" href="classBPNet.html#a98fa374aec169a3e741f2ce96fac7094">BPNet</a>, <a class="el" href="classHInputNet.html#a3ac18a3e39fc58647052518e507ae378">HInputNet</a>, <a class="el" href="classOutputBlendingNet.html#a089d2182d13a9f4dea2093843754dce7">OutputBlendingNet</a>, and <a class="el" href="classUESNet.html#ad05de4582dd40ae714fce3f9b0d3d2ca">UESNet</a>.</p>

</div>
</div>
<a class="anchor" id="a3c41ce6877aa3b04e5c19943bc78d007"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Net::setInputs </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the inputs to the network before running or training. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>array of doubles, the size of the input layer </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classBPNet.html#ad95c2a033ee8246637a6ce55e685429a">BPNet</a>, <a class="el" href="classHInputNet.html#a2c463ec5781f9e84865747e8bb085065">HInputNet</a>, and <a class="el" href="classOutputBlendingNet.html#a0ecd8c43dfce07092a8e7de0fc734bd4">OutputBlendingNet</a>.</p>

</div>
</div>
<a class="anchor" id="a2ef424e05bfeff073bbca57a5735c121"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Net::setSeed </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set this network's random number generator, which is used for weight initialisation done at the start of training. </p>

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00057">57</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5b4d9d5fcf5b31d2ae163cbe3f5b151f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double Net::test </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classExampleSet.html">ExampleSet</a> &amp;&#160;</td>
          <td class="paramname"><em>examples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test a network. Runs the network over a set of examples and returns the mean MSE for all outputs </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{1}{N\cdot N_{outs}}\sum^N_{e \in Examples} \sum_{i=0}^{N_{outs}} (e_o(i) - e_y(i))^2 \]" src="form_0.png"/>
</p>
<p> where <img class="formulaInl" alt="$N$" src="form_1.png"/> is the number of examples, <img class="formulaInl" alt="$N_{outs}$" src="form_2.png"/> is the number of outputs, <img class="formulaInl" alt="$e_o(i)$" src="form_3.png"/> is network's output for example <img class="formulaInl" alt="$e$" src="form_4.png"/>, and <img class="formulaInl" alt="$e_y(i)$" src="form_5.png"/> is the desired output for the same example. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">examples</td><td>Example set to test (or partially test). </td></tr>
    <tr><td class="paramname">start</td><td>index of example to start test at. </td></tr>
    <tr><td class="paramname">num</td><td>number of examples to test (or -1 for all after start point). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00142">142</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6ac1fa9f916aa77906581af9140b8175"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double Net::trainBatch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classExampleSet.html">ExampleSet</a> &amp;&#160;</td>
          <td class="paramname"><em>ex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Train a network for batch (or mini-batch) (or single example). </p>
<p>This will</p><ul>
<li>zero the average gradient variables for all weights and biases</li>
<li>zero the total error</li>
<li>for each example<ul>
<li>calculate the error with calcError() which itself calls <a class="el" href="classNet.html#ad02198e219d3ba060c88d764ce54b905" title="Run a single update of the network. ">update()</a></li>
<li>add to the total mean squared error (see NOTE below)</li>
</ul>
</li>
<li>for each weight and bias<ul>
<li>calculate the means across all provided examples</li>
<li>apply the mean to the weight or bias</li>
</ul>
</li>
<li>return the mean squared error (NOTE: different from original, which returned mean absolute error) for all outputs and examples: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{1}{N\cdot N_{outs}}\sum^N_{e \in Examples} \sum_{i=0}^{N_{outs}} (e_o(i) - e_y(i))^2 \]" src="form_0.png"/>
</p>
 where <img class="formulaInl" alt="$N$" src="form_1.png"/> is the number of examples, <img class="formulaInl" alt="$N_{outs}$" src="form_2.png"/> is the number of outputs, <img class="formulaInl" alt="$e_o(i)$" src="form_3.png"/> is network's output for example <img class="formulaInl" alt="$e$" src="form_4.png"/>, and <img class="formulaInl" alt="$e_y(i)$" src="form_5.png"/> is the desired output for the same example. <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ex</td><td>example set </td></tr>
    <tr><td class="paramname">start</td><td>index of first example to use </td></tr>
    <tr><td class="paramname">num</td><td>number of examples. For a single example, you'd just use 1. </td></tr>
    <tr><td class="paramname">eta</td><td>learning rate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the sum of mean squared errors in the output layer (see formula in method documentation) </dd></dl>
</li>
</ul>

<p>Implemented in <a class="el" href="classBPNet.html#a3f820464f3338ed7305e9de950cd2103">BPNet</a>, <a class="el" href="classOutputBlendingNet.html#a4c65f752aeedb75c230773965d35df3b">OutputBlendingNet</a>, and <a class="el" href="classUESNet.html#ac27da7319d8be1507ea80506e69437e5">UESNet</a>.</p>

</div>
</div>
<a class="anchor" id="a4e527a7773eed5fb071b78ef3a636c95"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double Net::trainSGD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classExampleSet.html">ExampleSet</a> &amp;&#160;</td>
          <td class="paramname"><em>examples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNet_1_1SGDParams.html">SGDParams</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Train using stochastic gradient descent. Note that cross-validation parameters are slightly different from those given in the thesis. Here we give the number of slices and number of examples per slice; in the thesis we give the total number of examples to be held out and the number of slices. </p>
<dl class="section pre"><dt>Precondition</dt><dd>Network has weights initialised to random values </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>The network will be set to the best network found if bestNetBuffer is set, otherwise the final network will be used. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::out_of_range</td><td>Too many CV examples </td></tr>
    <tr><td class="paramname">std::logic_error</td><td>Trying to select best by CV when there's no CV done</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">examples</td><td>training set (including cross-validation data) </td></tr>
    <tr><td class="paramname">params</td><td>a filled-in <a class="el" href="structNet_1_1SGDParams.html" title="Training parameters for trainSGD(). This structure holds the parameters for the trainSGD() method...">SGDParams</a> structure giving the parameters for the training. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If storeBestNet is null, the MSE of the final network; otherwise the MSE of the best network found. This is done across the entire validation set if provided, or the entire training set if not. </dd></dl>

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00428">428</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad02198e219d3ba060c88d764ce54b905"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Net::update </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Run a single update of the network. </p>
<dl class="section pre"><dt>Precondition</dt><dd>input layer must be filled with values </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>output layer contains result </dd></dl>

<p>Implemented in <a class="el" href="classBPNet.html#af60f5bfa6cb7dffd75a9a127b811a208">BPNet</a>, <a class="el" href="classOutputBlendingNet.html#a879f1eedcfad5238d9bdbc78ef5f8250">OutputBlendingNet</a>, and <a class="el" href="classUESNet.html#a1d05fcd3ce9f188db8841a9d6fc6c56c">UESNet</a>.</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a8e75331604ab50e15c580aeb31b3804f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classHInputNet.html">HInputNet</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00041">41</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9ffff8d20e4d424b4358f43e204c7d1b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classOutputBlendingNet.html">OutputBlendingNet</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00040">40</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a364288d09aeae0b47c5adbfb470a6c1c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">drand48_data Net::rd</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PRNG data (thread safe) </p>

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00050">50</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6b6b0fb9e01f10084ce304df6d8c841d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="netType_8hpp.html#a1526df0fc932ccf720aa26267f923213">NetType</a> Net::type</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>type of the network, used for load/save </p>

<p>Definition at line <a class="el" href="net_8hpp_source.html#l00049">49</a> of file <a class="el" href="net_8hpp_source.html">net.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/travis/build/jimfinnis/uesmanncpp/<a class="el" href="net_8hpp_source.html">net.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
